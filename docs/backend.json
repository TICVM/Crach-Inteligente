{
  "entities": {
    "Aluno": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Aluno",
      "type": "object",
      "description": "Representa um aluno registrado no sistema, contendo seus dados pessoais e de identificação para o crachá.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Identificador único para a entidade Aluno gerado pelo Firestore."
        },
        "nome": {
          "type": "string",
          "description": "Nome completo do aluno a ser exibido no crachá."
        },
        "turma": {
          "type": "string",
          "description": "Turma ou classe à qual o aluno pertence, exibida no crachá."
        },
        "fotoUrl": {
          "type": "string",
          "description": "URL de dados (Data URL) da imagem de perfil do aluno."
        },
        "customData": {
          "type": "object",
          "description": "Objeto para armazenar campos e valores personalizados definidos pelo usuário (ex: Matrícula, Validade)."
        }
      },
      "required": [
        "nome",
        "turma",
        "fotoUrl"
      ]
    },
    "ConfiguracaoCracha": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ConfiguracaoCracha",
      "type": "object",
      "description": "Armazena configurações globais para a geração de crachás, como o fundo personalizado.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Identificador único para a entidade ConfiguracaoCracha. Recomenda-se um ID fixo (ex: 'globalConfig') já que há apenas uma configuração global."
        },
        "fundoCrachaUrl": {
          "type": "string",
          "description": "URL ou identificador da imagem personalizada usada como fundo dos crachás, armazenada em um serviço de armazenamento de arquivos (ex: Firebase Storage). (Relationship: ConfiguracaoCracha 1:1 FundoImagem)"
        },
        "nomeFundoAtual": {
          "type": "string",
          "description": "Nome do arquivo da imagem de fundo atual, para exibição na interface do usuário."
        }
      },
      "required": [
        "id",
        "fundoCrachaUrl",
        "nomeFundoAtual"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/alunos/{alunoId}",
        "definition": {
          "entityName": "Aluno",
          "schema": {
            "$ref": "#/backend/entities/Aluno"
          },
          "description": "Armazena dados de cada aluno. Acesso de leitura e escrita é permitido para qualquer usuário autenticado anonimamente.",
          "params": [
            {
              "name": "alunoId",
              "description": "Identificador único do aluno, usado como ID do documento."
            }
          ]
        }
      },
      {
        "path": "/configuracaoCracha/{configuracaoId}",
        "definition": {
          "entityName": "ConfiguracaoCracha",
          "schema": {
            "$ref": "#/backend/entities/ConfiguracaoCracha"
          },
          "description": "Armazena configurações globais para a geração de crachás. Acesso de escrita é restrito a administradores. Acesso de leitura é público.",
          "params": [
            {
              "name": "configuracaoId",
              "description": "Identificador único para a configuração do crachá. Recomenda-se um ID fixo como 'global'."
            }
          ]
        }
      },
      {
        "path": "/roles_admin/{uid}",
        "definition": {
          "entityName": "roles_admin",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Coleção para definir administradores do sistema. A existência de um documento com o UID de um usuário aqui confere a ele a role de administrador.",
          "params": [
            {
              "name": "uid",
              "description": "O Firebase Auth UID do usuário que possui a role de administrador."
            }
          ]
        }
      }
    ],
    "reasoning": "A estrutura foi atualizada para usar o Firestore como banco de dados principal. A coleção `/alunos` agora armazena os dados dos estudantes, com regras de segurança que permitem que qualquer usuário autenticado (via autenticação anônima) leia e escreva dados. Isso facilita o uso da aplicação sem a necessidade de um sistema de login complexo, ao mesmo tempo que protege o banco de dados de acesso não autenticado. As outras coleções mantêm suas regras originais para configurações e roles de administrador."
  }
}
